---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/Navbar.astro';
import NoticiaCard from '../../components/NoticiaCard.astro';

// Busca e ordena as notícias por data (mais recente primeiro)
const todasNoticias = (await getCollection('noticias')).sort(
  (a, b) => new Date(b.data.data).getTime() - new Date(a.data.data).getTime()
);
---

<Layout title="Últimas Notícias | emguapi.com">
    <Navbar />

    <main class="max-w-6xl mx-auto p-6 my-12">
        {/* HEADER: Removido o italic e trocado border-ice por border-gray-200 */}
        <header class="mb-16 border-b border-gray-200 pb-10">
            <span class="text-red-base font-black uppercase tracking-[0.2em] text-[10px]">Fique por dentro</span>
            <h1 class="text-4xl md:text-6xl font-black text-navy-dark uppercase tracking-tighter mt-2 leading-none">
                Últimas <span class="text-red-base">Notícias</span>
            </h1>
        </header>

        {/* GRID: O NoticiaCard já foi atualizado anteriormente para rounded-lg e tag azul */}
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 md:gap-10">
            {todasNoticias.map(noticia => (
                <NoticiaCard 
                    categoria={noticia.data.categoria}
                    titulo={noticia.data.titulo}
                    resumo={noticia.data.resumo}
                    data={noticia.data.data}
                    
                    link={`/noticias/${noticia.id.replace(/\.md$/, '')}`}
                    imagem={noticia.data.imagem || "/fotos/emguapi-capa.png"}
                />
            ))}
        </div>

        {/* FOOTER DA PÁGINA: Mensagem de fim de arquivo */}
        {todasNoticias.length > 0 && (
            <div class="mt-20 pt-10 border-t border-gray-100 text-center">
                <p class="text-[10px] font-black uppercase tracking-[0.3em] text-gray-400">Você chegou ao fim do acervo</p>
            </div>
        )}
    </main>
</Layout>