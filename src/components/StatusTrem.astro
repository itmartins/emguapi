---
// src/components/StatusTrem.astro
import statusData from '../data/statusTrem.json';

const { estado, ultimaAtualizacao } = statusData;

// Configuração padrão
let config = {
    bg: "bg-green-600",
    border: "border-green-400",
    titulo: "Operação Normal",
    texto: "Trens circulando conforme a grade horária prevista.",
    // Novas propriedades para a luz
    luzCor: "bg-green-400", // A cor da bolinha
    luzGlow: "shadow-green-300", // A cor do brilho/sombra
    bgIcone: "bg-green-700/30" // Fundo do círculo onde fica a luz
};

// Lógica de cores baseada no estado do JSON
switch (estado.toLowerCase()) {
    case 'atrasado':
        config = {
            bg: "bg-yellow-500",
            border: "border-yellow-300",
            titulo: "Operação com Atrasos",
            texto: "Intervalos irregulares devido a ocorrências operacionais.",
            luzCor: "bg-yellow-200",
            luzGlow: "shadow-yellow-100",
            bgIcone: "bg-yellow-700/30"
        };
        break;
    case 'suspenso':
        config = {
            bg: "bg-red-base",
            border: "border-red-400",
            titulo: "Operação Suspensa",
            texto: "Circulação interrompida temporariamente no ramal.",
            luzCor: "bg-red-200",
            luzGlow: "shadow-red-900", // Sombra escura para destacar o vermelho claro
            bgIcone: "bg-red-900/30"
        };
        break;
    case 'manutencao':
        config = {
            bg: "bg-navy-base",
            border: "border-navy-soft",
            titulo: "Manutenção Programada",
            texto: "A circulação será normalizada na segunda-feira, na primeira viagem do dia.",
            luzCor: "bg-blue-300",
            luzGlow: "shadow-blue-200",
            bgIcone: "bg-blue-900/30"
        };
        break;
}
---

<div class={`rounded-[2rem] p-6 ${config.bg} text-white shadow-xl flex flex-col md:flex-row items-center gap-6 border-4 ${config.border} relative overflow-hidden group hover:scale-[1.01] transition-transform duration-300`}>
    
    <div class="absolute -right-16 -top-16 w-64 h-64 rounded-full bg-white/5 pointer-events-none blur-3xl"></div>

    <div class={`w-24 h-24 rounded-full flex items-center justify-center shadow-inner backdrop-blur-sm z-10 border border-white/10 ${config.bgIcone}`}>
        
        <span class="relative flex h-8 w-8">
            <span class={`animate-ping absolute inline-flex h-full w-full rounded-full opacity-75 ${config.luzCor}`}></span>
            
            <span class={`relative inline-flex rounded-full h-8 w-8 shadow-[0_0_15px_rgba(255,255,255,0.6)] ${config.luzCor}`}></span>
        </span>

    </div>

    <div class="flex-1 text-center md:text-left z-10">
        <h3 class="text-xl font-black uppercase italic tracking-tighter mb-2 text-white drop-shadow-md">
            Status: {config.titulo}
        </h3>
        <p class="font-medium leading-tight opacity-95 text-sm md:text-base">{config.texto}</p>
        
        <div class="mt-4 flex items-center justify-center md:justify-start gap-2 opacity-70">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3">
              <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.75-13a.75.75 0 00-1.5 0v5c0 .414.336.75.75.75h4a.75.75 0 000-1.5h-3.25V5z" clip-rule="evenodd" />
            </svg>
            <p class="text-[10px] font-black uppercase tracking-widest">
                Atualizado em: {ultimaAtualizacao}
            </p>
        </div>
    </div>
</div>